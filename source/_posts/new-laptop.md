---
title: 再见，老伙计；你好，新朋友
tags:
  - Hardware
  - Everything
date: 2018-05-12 21:12:12
---

前略，上周日，一次突如其来的停电袭击之后，我那本来就已经处在崩溃边缘的 K610D 终于不得行了，进系统之后必蓝屏，而且此次蓝屏的 Code 还不一样（说实话可能我基本上把 Windows 10 能出现的蓝屏代码全看了一遍了）。花了半天尝试了各种修复后故障依旧，没有办法之下，只得跟父亲申请新机器的资金——其实已经延长了非常久的时间了，自从两年前进过水之后我就知道必然会有这么一天到来的——再花了四分之一天在限定资金下确定了现在这台新伙计，用的蓝天 W65KJ 的模具。
配置最基本两个大件新旧对比：

|      |      K610D-i7d2      |          W65KJ          |
| :--: | :------------------: | :---------------------: |
| CPU  | Intel Core i7 4710MQ | Intel Core i3 8100      |
| GPU  | NVIDIA GeForce 940M  | NVIDIA GeForce GTX 1050 |

之所以新机器选择了 W65KJ, 原因有二：

1. 散热强劲

   因为用的是桌面级 CPU, 所以 CPU 部分是用了双热管来压的，而且 CPU 与 dGPU 各用了一个风扇来分散热量。之前因为在 K610D 上面吃尽了散热差的苦头，所以这次舍弃了拥有更好扩展接口的另一个型号，也要散热系统非常强劲。

   测试下来非常令我满意，在风扇全开的情况下能把 CPU 压在 65 度附近，四核频率稳定标称的 3.6 GHz 运行，dGPU 也压的非常好。

2. 可扩展性强

   因为用的是桌面级 Core 8 代 CPU, 所以机器上直接给了两个 M.2 接口，两个均支持 NVMe 协议。而且因为散热系统仍有余裕，所以后续升级至 Core i5 是非常可行的提升性能的办法，甚至 i7 都有一试之力。

京东速度还算是不错，第二天周一中午机器到手的时候是 8GB 2400 的英睿达单条 DDR4 内存加上一条金士顿的 128 GB 的 TLC 条子，成本原因自然是走 SATA 协议的，但是够用是够用了，就是容量太小了，于是当天下午就下单了另一条英睿达 DDR4 2400 8GB 和三星的 SM961 256GB, 最谢天谢地的是最近的内存条和 SSD 都有一些降价，不然得是大出血。

犹豫是周一下午五点——一般快递停收时间——之后才淘宝下的单，所以内存到了周五才到，而 SM961 却到了周三还没发货，咨询了卖家：“没货，明天或者后天到”。我可去你妈的，换店，之前物色 NVMe SSD 的时候在 XG3 和 SM961 之间纠结，然后这时候在淘宝上看到一家拆机 XG3 512GB 才卖九百出头的店，果断付款。

然后今天周六下午，终于是到手了。赶紧插上装好东芝家的驱动跑个分，果然 NVMe + MLC 的组合数据上非常吓人。马上迁移系统，结果文件都是复制完了却在启动上栽了跟头。

## 系统迁移引导处理

在 UEFI + GPT 环境下直接复制全盘复制文件到新分区是可行的，前提是你的 NVMe 在原来的系统中要被认过一次，系统的设备管理器中的“存储控制器”一项出现了 NVMe 控制器，这是迁移可行的大前提。

文件复制完毕之后，你还需要做两个事情，否则，是进不去新驱动器上的系统的：

### 改变注册表中默认分配盘符

首先你需要一个可用的注册表编辑器，定位到 `HKLM\SYSTEM\MountedDevices` 下，将 `\DosDevices\新系统所在的盘符:` 的值复制下来。挂载上新系统的注册表文件（通过文件-加载配置单元读取 `Windows\System32\Config\SYSTEM` 文件），然后定位到相同的项，将之前复制的值覆盖掉 `\DosDevices\C:` 的值即可。

### 写入新的 BCD 配置

然后你需要一块系统安装盘，启动到系统安装界面，调出命令行(Shift + F10), 然后将新系统所在的分区的盘符挂成 "C", 同时要给新硬盘上的 ESP 分区分配一个盘符，使程序能够写入文件，大概过程如下：

```batch
diskpart
list disk '查看磁盘列表
sele disk x 'x 是你新磁盘在列表中的编号
list part
sele part x 'x 是你新系统所在的分区编号
assign letter=C '分配新系统所在分区的盘符为 C
sele part y 'y 是这块磁盘上的 ESP 分区编号
assign letter=Y '给 ESP 分区分配 Y 的盘符
exit '退出 diskpart
bcdboot C:\windows /s Y: [/v] '将 C:\Windows 作为启动目录写入到 Y: 上，"/v" 为可选参数，即详细模式
```

重启之后就搞定了。

---

那么，这台机子就这么算是正式启用了吧，之后会攒钱买块 Core i5 给换上就算是完全大功告成了，但愿它能陪我长一些时间吧。